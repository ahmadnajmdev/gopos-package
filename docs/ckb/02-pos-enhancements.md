# باشترکردنی مۆدیوڵی خاڵی فرۆشتن (POS)

## پوختە

مۆدیوڵی خاڵی فرۆشتن (POS) دڵی کارەکانی فرۆشتنی ڕۆژانەیە. هەموو شتێک بەڕێوەدەبات لە فرۆشتنی سادەوە تا سیناریۆ ئاڵۆزەکان وەک پارەدانی دابەشکراو، بەرنامەی وەفاداری کڕیار، و بەڕێوەبردنی شەفت لەگەڵ بەدواداچوونی پارەی کاش.

---

## بۆچی ئەم تایبەتمەندییانە بەکاربهێنیت؟

### سوودە سەرەکییەکان

| سوود | چۆن یارمەتی کارەکەت دەدات |
|------|--------------------------|
| **بەرپرسیاریەتی پارەی کاش** | بەڕێوەبردنی شەفت هەر دینارێک بەدواداچوون دەکات - بزانە پارە بۆ کوێ دەچێت |
| **نەرمی پارەدان** | ڕێگەی پارەدانی زۆر لە یەک مامەڵە وەربگرە |
| **هێشتنەوەی کڕیار** | بەرنامەی وەفاداری کڕیاران دەگەڕێنێتەوە |
| **کاریگەری کاری** | هەڵگرتن/هێنانەوەی فرۆشتن ڕێگری لە ونبوونی مامەڵە دەکات |
| **پسوولەی پڕۆفیشناڵ** | فۆرماتی چاپی زۆر بۆ هەر چاپەرێک |

### کێشەکانی کە چارەسەر دەکات

- **"پارەی کاش هەمیشە کەمە لە کۆتایی ڕۆژ"** - بەدواداچوونی شەفت لەگەڵ ڕاپۆرتی جیاوازی
- **"کڕیار دەیەوێت نیوەی بە کاش و نیوەی بە کارت بدات"** - پشتگیری پارەدانی دابەشکراو
- **"کڕیارە دووبارەکان لەدەست دەدەین"** - خاڵی وەفاداری هانی گەڕانەوە دەدات
- **"کڕیار جزدانی بیرچۆتەوە، فرۆشتن لەدەستچوو"** - فرۆشتن هەڵبگرە تا دەگەڕێتەوە
- **"پسوولەکانمان پڕۆفیشناڵ نین"** - فۆرماتی پسوولەی کەسایەتیپێدراو

---

## کێ دەبێت ئەمە بخوێنێت؟

| ڕۆڵ | بەشە پەیوەندیدارەکان |
|------|---------------------|
| **کاشێرەکان** | بەڕێوەبردنی شەفت، پارەدانی دابەشکراو، هەڵگرتن/هێنانەوە |
| **بەڕێوەبەرانی فرۆشگا** | هەموو بەشەکان - بەتایبەتی ڕاپۆرتی شەفت |
| **خاوەنانی کار** | بەرنامەی وەفاداری، ڕاپۆرتی شەفت |
| **گەشەپێدەران** | هەموو بەشەکان بۆ تێکەڵکردن |

---

## پێکهاتەکانی مۆدیوڵ

```
┌─────────────────────────────────────────────────────────────────────────┐
│                      باشترکردنی خاڵی فرۆشتن                             │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ┌───────────────────┐   بەدواداچوونی کاش، ڕێگری لە دزی، بەرپرسیاریەتی  │
│  │ بەڕێوەبردنی شەفت  │   بەکاربهێنە کات: دەستپێکردن/کۆتایی ڕۆژی کار    │
│  └───────────────────┘                                                  │
│                                                                         │
│  ┌───────────────────┐   ڕێگەی پارەدانی زۆر لە یەک فرۆشتن               │
│  │ پارەدانی دابەشکراو│   بەکاربهێنە کات: کڕیار کاش + کارت دەدات        │
│  └───────────────────┘                                                  │
│                                                                         │
│  ┌───────────────────┐   پاداشتکردنی کڕیارە دووبارەکان                  │
│  │ بەرنامەی وەفاداری │   بەکاربهێنە کات: دروستکردنی پەیوەندی کڕیار     │
│  └───────────────────┘                                                  │
│                                                                         │
│  ┌───────────────────┐   وەستانی فرۆشتن، درێژەدان دواتر                 │
│  │ هەڵگرتن/هێنانەوە  │   بەکاربهێنە کات: کڕیار کاتی دەچێت             │
│  └───────────────────┘                                                  │
│                                                                         │
│  ┌───────────────────┐   دروستکردنی پسوولە بۆ هەر چاپەرێک              │
│  │  چاپکردنی پسوولە  │   بەکاربهێنە کات: تەواوکردنی هەر فرۆشتنێک       │
│  └───────────────────┘                                                  │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## تایبەتمەندی ١: بەڕێوەبردنی شەفت

### چییە؟

بەڕێوەبردنی شەفت دانیشتنی هەر کاشێرێک بەدواداچوون دەکات لە کردنەوەوە تا داخستن. تۆمار دەکات:
- بڕی پارەی کاشی کردنەوە
- هەموو فرۆشتن و گەڕاندنەوەکان لە کاتی شەفت
- زیادکردنی پارەی کاش (Hatni Pare)
- دەرکردنی پارەی کاش (Chuni Pare)
- ژماردنی پارەی کاشی داخستن و هەر جیاوازییەک

### سوودە سەرەکییەکان

| سوود | وەسف |
|------|------|
| **بەرپرسیاریەتی کاش** | بزانە بە تەواوی چەندە دەبێت لە سندووقدا بێت |
| **ڕێگری لە دزی** | جیاوازییەکان دەستبەجێ دەردەکەون و تۆمار دەکرێن |
| **گواستنەوەی ئاسان** | خاڵی دەستپێک/کۆتایی ڕوون بۆ گۆڕینی شەفت |
| **شوێنی پشکنین** | مێژووی تەواو بۆ هەموو جوڵەی پارەی کاش |
| **ڕاپۆرتی Z** | ڕاپۆرتی کۆتایی شەفت |

### کەی بەکاربهێنە

| سیناریۆ | کردەوە |
|---------|--------|
| دەستپێکردنی ڕۆژی کار | شەفتی نوێ بکەوە |
| کۆتایی ڕۆژی کار | شەفتەکە داخە |
| زیادکردنی پارەی ورد بۆ سندووق | هاتنی پارە تۆمار بکە |
| دەرکردنی پارە بۆ گۆڕینەوە | چوونی پارە تۆمار بکە |
| گواستنەوە بۆ کاشێری دوایی | شەفت داخە، ئەو شەفتی نوێ دەکاتەوە |
| بەڕێوەبەر چالاکی ڕۆژانە پێداچوونەوە دەکات | ڕاپۆرتی Z ببینە |

### حاڵەتی بەکارهێنان: کارەکانی ڕۆژانەی فرۆشتن

**سیناریۆ:** ئەحمەد شەفتەکەی دەستپێدەکات کاتژمێر ٩ی بەیانی لەگەڵ ٥٠,٠٠٠ دینار لە سندووقدا.

**بەیانی:**
1. ئەحمەد شەفت دەکاتەوە، ٥٠,٠٠٠ دینار پارەی کاشی کردنەوە دەنووسێت
2. بەردەوام دەبێت لە ئەنجامدانی فرۆشتن بەدرێژایی بەیانی
3. لە نیوەڕۆ، ١٠,٠٠٠ دینار هاتنی پارە تۆمار دەکات (پارەی ورد)

**دوای نیوەڕۆ:**
1. کڕیارێک پێویستی بە گۆڕینەوەی ٢٠,٠٠٠ دینارە بۆ پارەی بچووکتر
2. ئەحمەد ئەمە وەک چوونی پارە تۆمار دەکات
3. بەردەوام دەبێت لە ئەنجامدانی فرۆشتن

**کۆتایی شەفت:**
1. ئەحمەد پارە کاشەکە دەژمێرێت: ١٨٥,٠٠٠ دینار
2. سیستەم چاوەڕوانکراوی حیساب دەکات: ١٨٠,٠٠٠ دینار
3. ئەحمەد ٥,٠٠٠ دینار زیادی هەیە - تێبینی دەکات "پارەی ورد لەژێر سندووقدا دۆزرایەوە"
4. بەڕێوەبەر ڕاپۆرتی Z پێداچوونەوە دەکات و ڕازی دەبێت

### چۆن بەکاربهێنیت (هەنگاوەکانی ڕووکار)

#### کردنەوەی شەفت

1. بڕۆ بۆ **فرۆشتن > بەڕێوەبردنی شەفت** یان کلیک لەسەر ئایکۆنی شەفت لە POS
2. کلیک لەسەر **کردنەوەی شەفت**
3. **پارەی کاشی کردنەوە** بنووسە (بژمێرە چی لە سندووقدایە)
4. بە هەڵبژاردن **ناسنامەی تێرمیناڵ** بنووسە (وەک "POS-1")
5. کلیک لەسەر **کردنەوەی شەفت**

> **گرنگ:** تەنها یەک شەفت دەتوانیت لە یەک کاتدا بکەیتەوە. کردنەوەی شەفتی نوێ بە شێوەی خۆکار هەر شەفتێکی بەردەست دادەخات.

#### لە کاتی شەفتەکەت

لە کاتی کارکردن:
- هەموو فرۆشتنەکان بە شێوەی خۆکار پەیوەست دەبن بە شەفتی ئێستات
- مامەڵەکانی کاش لە کاتی ڕاستەقینە بەدواداچوون دەکرێن
- کۆی گشتی پارەی ناو سندووق لە هەر کاتێک لە بەڕێوەبردنی شەفت ببینە

#### تۆمارکردنی هاتنی/چوونی پارە

بۆ جوڵەی پارەی کاش کە فرۆشتن نین:

1. لە بەڕێوەبردنی شەفت، کلیک لەسەر **هاتنی پارە** یان **چوونی پارە**
2. بڕەکە بنووسە
3. تێبینی زیاد بکە کە جوڵەکە ڕوون بکاتەوە (پێویستە بۆ شوێنی پشکنین)
4. مامەڵەکە دووپات بکەوە

**نموونەکان:**
- هاتنی پارە: "پارەی ورد لە بەڕێوەبەرەوە"
- چوونی پارە: "گۆڕینەوە بۆ کڕیار"
- چوونی پارە: "پارەدان بۆ کرێکاری گەیاندن"

#### داخستنی شەفتەکەت

1. بڕۆ بۆ **فرۆشتن > بەڕێوەبردنی شەفت**
2. کلیک لەسەر **داخستنی شەفت**
3. پارەی کاشی فیزیکی بە وریایی بژمێرە
4. بڕی **کاشی ژمێردراو** بنووسە
5. سیستەم نیشان دەدات:
   - کاشی چاوەڕوانکراو (حیسابکراو لە مامەڵەکان)
   - جیاوازی (پۆزەتیڤ = زیاد، نیگەتیڤ = کەم)
6. تێبینی زیاد بکە کە هەر جیاوازییەک ڕوون بکاتەوە
7. کلیک لەسەر **داخستنی شەفت**

### کۆد

```php
use App\Services\POSSessionService;

$sessionService = app(POSSessionService::class);

// کردنەوەی شەفت
$session = $sessionService->openSession(
    user: auth()->user(),
    openingCash: 50000,
    terminalId: 'POS-1'
);

// تۆمارکردنی جوڵەی کاش
$sessionService->recordCashIn($session, 10000, 'پارەی ورد');
$sessionService->recordCashOut($session, 5000, 'گۆڕینەوە بۆ کڕیار');

// داخستنی شەفت
$sessionService->closeSession(
    session: $session,
    closingCash: 125000,
    closedBy: auth()->user(),
    notes: 'هەموو شت تەواوە'
);
```

### باشترین ڕەوشتەکان

| بکە | مەکە |
|-----|------|
| کاش بە وریایی بژمێرە پێش کردنەوە | بڕەکانی کردنەوە بە خەمڵاندن دابنێ |
| هەر هاتنی/چوونی پارەیەک بە تێبینی تۆمار بکە | پارە بجوڵێنە بەبێ تۆمارکردن |
| شەفت داخە پێش ڕۆیشتن | شەفت بە کراوەیی بهێڵەوە بە شەو |
| هەر جیاوازییەک لە تێبینی ڕوون بکەوە | جیاوازییەکان پشتگوێ بخە |
| ناوچەی سندووق پارێزراو بهێڵەوە | سندووق بە کراوەیی بهێڵەوە |

---

## تایبەتمەندی ٢: پارەدانی دابەشکراو

### چییە؟

پارەدانی دابەشکراو ڕێگا دەدات بە کڕیاران کە بە چەند ڕێگەیەک لە یەک مامەڵەدا پارە بدەن. بۆ نموونە، کڕیارێک دەتوانێت ٥٠,٠٠٠ دینار کاش و ئەوەی دەمێنێتەوە ٣٠,٠٠٠ دینار بە کارت بدات.

### سوودە سەرەکییەکان

| سوود | وەسف |
|------|------|
| **ڕاحەتی کڕیار** | فرۆشتن لەدەست مەدە کاتێک کڕیار پارەدانی تەواوی بە یەک ڕێگە پێ نییە |
| **نەرمی** | هەر تێکەڵەیەکی جۆری پارەدان وەربگرە |
| **بەدواداچوونی ورد** | هەر ڕێگەی پارەدان بە جیا بەدواداچوون دەکرێت |
| **حیسابکردنی گەڕاوە** | حیسابی خۆکار بۆ گەڕاوە بۆ بەشی کاش |

### کەی بەکاربهێنە

| سیناریۆ | پارەدانی دابەشکراو بەکاربهێنە |
|---------|------------------------------|
| کڕیار کاشی تەواوی نییە | پارەدانی کارت زیاد بکە بۆ ئەوەی دەمێنێتەوە |
| کڕیار دەیەوێت کارتی دیاری + کاش بەکاربهێنێت | لەنێوان هەردووکیان دابەش بکە |
| کڕیار باڵانسی فرۆشگای هەیە | باڵانس جێبەجێ بکە + ئەوەی دەمێنێتەوە کۆ بکەوە |
| حاڵەتی پارەدانی بە کۆمەڵ | هەر کەسێک پارەی خۆی دەدات |

### چۆن بەکاربهێنیت (هەنگاوەکانی ڕووکار)

1. لە POS، کاڵاکان زیاد بکە بۆ سەبەتە وەک ئاسایی
2. کلیک لەسەر **پارەدان**
3. هەڵبژاردنی **پارەدانی دابەشکراو** چالاک بکە
4. بۆ هەر پارەدانێک:
   - ڕێگەی پارەدان هەڵبژێرە (کاش، کارت، گواستنەوەی بانکی، مۆبایل، باڵانس)
   - بڕی ئەم پارەدانە بنووسە
   - بۆ کاش: بڕی وەرگیراو بنووسە بۆ حیسابکردنی گەڕاوە
   - کلیک لەسەر **زیادکردنی پارەدان**
5. بەردەوام بە تا کۆی گشتی دادەپۆشرێت (ماوە ٠ نیشان دەدات)
6. کلیک لەسەر **تەواوکردنی فرۆشتن**

### ڕێگەکانی پارەدانی بەردەست

| ڕێگە | کۆد | وەسف | کەی بەکاربهێنە |
|------|-----|------|---------------|
| کاش | `cash` | پارەی فیزیکی | پارەدانی کاشی کەسی |
| کارت | `card` | کارتی بانکی | پارەدانی کارت |
| گواستنەوەی بانکی | `bank_transfer` | گواستنەوەی ڕاستەوخۆ | گواستنەوەکانی پێشوەخت |
| پارەدانی مۆبایل | `mobile_payment` | FIB، FastPay، هتد. | پارەدانی جزدانی مۆبایل |
| باڵانس | `credit` | باڵانسی فرۆشگا | کڕیار باڵانسی هەیە |

---

## تایبەتمەندی ٣: بەرنامەی وەفاداری کڕیار

### چییە؟

سیستەمی وەفاداری کڕیاران پاداشت دەکات بۆ کڕینەکانیان. کڕیاران خاڵ کۆدەکەنەوە کاتێک دەکڕن، و خاڵەکان دەگۆڕنەوە بۆ داشکاندن لەسەر کڕینەکانی داهاتوو. سیستەم ئاستەکان پشتگیری دەکات (برۆنز، زیو، ئاڵتوون، پلاتینیۆم) بۆ کڕیارە تایبەتەکان.

### سوودە سەرەکییەکان

| سوود | وەسف |
|------|------|
| **هێشتنەوەی کڕیار** | خاڵ هۆکار دەدات بە کڕیاران بۆ گەڕانەوە |
| **زیادبوونی فرۆشتن** | کڕیاران زیاتر خەرج دەکەن بۆ کۆکردنەوە/بەکارهێنانی خاڵ |
| **داتای کڕیار** | بەدواداچوونی مێژووی کڕین و خواستەکان |
| **سەرکەوتنی ڕکابەری** | جیاوازی لە ڕکابەران کە بەرنامەی وەفاداری نییان |

### چۆن خاڵەکان کار دەکەن

#### کۆکردنەوەی خاڵ

خاڵەکان بە شێوەی خۆکار حیساب دەکرێن لەسەر بڕی کڕین:

```
خاڵی کۆکراوە = بڕی کڕین × خاڵ بۆ هەر پارە

نموونە:
- خاڵ بۆ هەر پارە: 0.01 (١ خاڵ بۆ هەر ١٠٠ دینار)
- کڕین: ٥٠,٠٠٠ دینار
- خاڵی کۆکراوە: ٥٠,٠٠٠ × ٠.٠١ = ٥٠٠ خاڵ
```

#### گۆڕینەوەی خاڵ

خاڵەکان دەگۆڕدرێنەوە بۆ نرخی داشکاندن:

```
نرخی داشکاندن = خاڵ × پارە بۆ هەر خاڵ

نموونە:
- پارە بۆ هەر خاڵ: ١٠ (هەر خاڵ = ١٠ دینار)
- خاڵ بۆ گۆڕینەوە: ٥٠٠
- داشکاندن: ٥٠٠ × ١٠ = ٥,٠٠٠ دینار داشکاندن
```

### کۆد

```php
use App\Services\LoyaltyService;

$loyaltyService = app(LoyaltyService::class);

// تۆمارکردنی کڕیار لە بەرنامەی وەفاداری
$loyalty = $loyaltyService->enrollCustomer($customer);

// دانی خاڵ بۆ فرۆشتن
$transaction = $loyaltyService->awardPointsForSale($sale);

// پشکنینی ئایا کڕیار دەتوانێت خاڵ بگۆڕێتەوە
if ($loyaltyService->canRedeem($customer, 500)) {
    $value = $loyaltyService->calculateRedemptionValue($customer, 500);
    $transaction = $loyaltyService->redeemPoints($customer, 500, $sale);
}

// زیادکردنی خاڵی زیادە (عرض، ڕۆژی لەدایکبوون)
$loyaltyService->addBonusPoints($customer, 100, 'پاداشتی ڕۆژی لەدایکبوون');
```

---

## تایبەتمەندی ٤: هەڵگرتن/هێنانەوەی فرۆشتن

### چییە؟

هەڵگرتن/هێنانەوە ڕێگا دەدات بە کاشێرەکان کە فرۆشتنێکی بەردەست ڕابگرن و دواتر بەردەوامی پێ بدەن. کاڵاکانی سەبەتە و زانیاری کڕیار پاشکەوت دەکرێن، و دەتوانرێت دووبارە بار بکرێنەوە لە POS کاتێک ئامادە بوو.

### سوودە سەرەکییەکان

| سوود | وەسف |
|------|------|
| **فرۆشتن لەدەست مەدە** | کڕیار دەتوانێت بەردەوام بێت لە کڕین بەبێ لەدەستدانی سەبەتە |
| **خزمەتکردن بە کڕیارانی تر** | سندووق ئازاد بکە لە کاتی چاوەڕوانی |
| **کەمکردنەوەی هەڵە** | کاڵاکان لە سیستەم دەمێنن، پێویست نییە دووبارە سکان بکرێن |
| **خزمەتی کڕیار** | گونجاندن لەگەڵ کڕیارانی کە پێویستە بچن |

### کەی بەکاربهێنە

| سیناریۆ | کردەوە |
|---------|--------|
| کڕیار جزدانی بیرچۆتەوە، دەچێت بۆ ئۆتۆمبێل | فرۆشتن هەڵبگرە، کڕیاری دوایی بخەنە بەر |
| کڕیار دەیەوێت زیاتر بهێنێت | فرۆشتن هەڵبگرە، بەردەوام دەبێت لە کڕین |
| کڕیار پێویستی بە پشکنینە لەگەڵ کەسێک | فرۆشتن هەڵبگرە، پەیوەندی دەکات |
| پارەدانی گەورە پێویستی بە ڕازیبوونی بەڕێوەبەرە | فرۆشتن هەڵبگرە، بەڕێوەبەر بانگ بکە |

### چۆن بەکاربهێنیت (هەنگاوەکانی ڕووکار)

#### هەڵگرتنی فرۆشتن

1. لە کاتی بوون لە POS لەگەڵ کاڵا لە سەبەتە
2. کلیک لەسەر دوگمەی **هەڵگرتنی فرۆشتن**
3. بە هەڵبژاردن تێبینی سەرچاوە زیاد بکە (وەک "ناوی کڕیار"، "هۆکار")
4. سەبەتە پاشکەوت دەکرێت و پاک دەکرێتەوە
5. ئێستا دەتوانیت فرۆشتنی نوێ دەستپێ بکەیت

#### هێنانەوەی فرۆشتنی هەڵگیراو

1. کلیک لەسەر دوگمەی **فرۆشتنە هەڵگیراوەکان**
2. لیستەکە ببینە کە نیشان دەدات:
   - ناوی کڕیار (ئەگەر دیاریکرابوو)
   - ژمارەی کاڵاکان
   - کۆی گشتی
   - کاتی هەڵگرتن
   - تێبینییەکان
3. کلیک لەسەر **بەردەوامکردن** لەسەر فرۆشتنی دەتەوێت
4. سەبەتە دەگەڕێندرێتەوە لەگەڵ هەموو کاڵاکان
5. فرۆشتن بە شێوەی ئاسایی تەواو بکە

### کۆد

```php
use App\Models\HeldSale;

// هەڵگرتنی فرۆشتن
$heldSale = HeldSale::create([
    'user_id' => auth()->id(),
    'customer_id' => $customerId,
    'cart_data' => $cartItems,
    'form_data' => $formData,
    'total_amount' => $total,
    'notes' => 'کڕیار زیاتر دەهێنێت',
    'expires_at' => now()->addHours(24),
]);

// لیستی فرۆشتنە هەڵگیراوەکان بۆ بەکارهێنەری ئێستا
$heldSales = HeldSale::active()
    ->forUser(auth()->user())
    ->latest()
    ->get();
```

---

## تایبەتمەندی ٥: چاپکردنی پسوولە

### چییە؟

سیستەمی پسوولە پسوولەی پڕۆفیشناڵ بە فۆرماتی زۆر دروست دەکات بۆ کارکردن لەگەڵ هەر جۆرە چاپەرێک - لە چاپی وێبگەڕەوە تا چاپەرەکانی پسوولەی گەرمی (Thermal).

### فۆرماتەکانی دەرچوون

| فۆرمات | باشترینە بۆ | وەسف |
|--------|------------|------|
| **HTML** | چاپی وێبگەڕ، ئیمەیل | فۆرماتی وێب ستاندارد |
| **دەقی خاو** | چاپەری تەنها دەق | دەقی ساکار، پانی جێگیر |
| **ESC/POS** | چاپەرە گەرمیەکان | فەرمانەکانی ستانداردی پیشەسازی |

### کۆد

```php
use App\Services\ReceiptPrinterService;

$receiptService = app(ReceiptPrinterService::class);

// ڕێکخستنی پسوولە
$receiptService->setConfig([
    'business_name' => 'فرۆشگاکەم',
    'paper_width' => 48,
    'footer_message' => 'سوپاس بۆ کڕینەکەت!',
    'show_tax_breakdown' => true,
    'show_loyalty_points' => true,
]);

// دروستکردنی داتای پسوولەی تەواو
$receipt = $receiptService->generateReceipt($sale);

// دەستگەیشتن بە فۆرماتی تایبەت
$html = $receipt['html'];
$text = $receipt['raw_text'];
$escpos = $receipt['escpos']['commands'];
```

---

## سەرچاوەی تەکنیکی

### نەخشەی داتابەیس

#### pos_sessions

| ستوون | جۆر | وەسف |
|-------|-----|------|
| id | bigint | کلیلی سەرەکی |
| user_id | bigint | ناسنامەی بەکارهێنەری کاشێر |
| terminal_id | string | ناسنامەی تێرمیناڵ |
| opening_time | timestamp | کاتی دەستپێکی شەفت |
| closing_time | timestamp | کاتی کۆتایی شەفت |
| opening_cash | decimal | بڕی کاشی کردنەوە |
| closing_cash | decimal | بڕی داخستنی ژمێردراو |
| expected_cash | decimal | کاشی چاوەڕوانکراوی حیسابکراو |
| cash_difference | decimal | بڕی زیاد/کەم |
| status | enum | open, closed, suspended |

#### sale_payments

| ستوون | جۆر | وەسف |
|-------|-----|------|
| id | bigint | کلیلی سەرەکی |
| sale_id | bigint | فرۆشتنی سەرەکی |
| payment_method | string | کاش، کارت، هتد. |
| amount | decimal | بڕی پارەدان |
| reference_number | string | سەرچاوەی کارت/گواستنەوە |
| tendered_amount | decimal | کاشی دراو |
| change_amount | decimal | گەڕاوەی دراوە |

#### held_sales

| ستوون | جۆر | وەسف |
|-------|-----|------|
| id | bigint | کلیلی سەرەکی |
| user_id | bigint | کاشێری کە هەڵیگرت |
| customer_id | bigint | کڕیار (بژاردەیی) |
| cart_data | json | کاڵاکانی سەبەتە |
| total_amount | decimal | کۆی سەبەتە |
| notes | string | تێبینی سەرچاوە |
| expires_at | timestamp | کاتی سڕینەوەی خۆکار |

---

## چارەسەرکردنی کێشە

### شەفت ناکرێتەوە

**کێشە:** ناتوانم شەفتی نوێ بکەمەوە.

**چارەسەرەکان:**
1. بپشکنە ئایا شەفتی کراوەت هەیە (یەکەم داخە)
2. دڵنیابە دەسەڵاتی `pos.access` هەیە
3. کاش پاک بکەوە: `php artisan optimize:clear`

---

### کۆی پارەدانی دابەشکراو هاوتا نییە

**کێشە:** دوای زیادکردنی هەموو پارەدانەکان، بڕی ماوە سفر نییە.

**چارەسەرەکان:**
1. دڵنیابە هەر بڕی پارەدان بە دروستی نوسراوە
2. ڕێژەی گۆڕینەوەی پارە بپشکنە ئەگەر پارەی زۆر بەکاردەهێنیت
3. فانکشنی پشتڕاستکردنەوە بەکاربهێنە پێش پرۆسەکردن

---

### خاڵی وەفاداری نادرێت

**کێشە:** کڕیار کڕینی کرد بەڵام خاڵی نەگرت.

**چارەسەرەکان:**
1. دڵنیابە کڕیار پەیوەست بوو بە فرۆشتنەکە
2. بپشکنە بەرنامەی وەفاداری چالاکە
3. دڵنیابە `points_per_currency` > 0 لە ڕێکخستنەکانی بەرنامە
4. دڵنیابە کڕیار تۆمارکراوە لە بەرنامە

---

### پسوولە چاپ ناکرێت

**کێشە:** پسوولە ناچاپکرێت لەسەر چاپەری گەرمی.

**چارەسەرەکان:**
1. بپشکنە چاپەر پەیوەستە و کاردەکات
2. دڵنیابە فەرمانەکانی ESC/POS لەگەڵ مۆدێلی چاپەرەکەت دەگونجێن
3. سەرەتا بە فۆرماتی دەقی خاو تاقی بکەرەوە
4. ڕێکخستنەکانی پەیوەندی چاپەر IP/USB بپشکنە

---

### فرۆشتنی هەڵگیراو ونبوو

**کێشە:** فرۆشتنێکی هەڵگیراو چیتر لە لیستەکە نییە.

**چارەسەرەکان:**
1. بپشکنە ئایا بەسەرچوو (بەرەو بنەڕەت: ٢٤ کاتژمێر)
2. بەکارهێنەرێکی تر لەوانەیە بەردەوامی پێ دابێت
3. کەسێک لەوانەیە سڕیبێتیەوە
4. خشتەی held_sales ڕاستەوخۆ بپشکنە

---

*دوایین نوێکردنەوە: کانوونی دووەم ٢٠٢٦*
