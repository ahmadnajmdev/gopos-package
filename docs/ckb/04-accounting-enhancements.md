# باشترکردنی مۆدیوڵی ژمێریاری

## پێشەکی

مۆدیوڵی ژمێریاری توانای بەڕێوەبردنی دارایی بە ئاستی دامەزراوەیی دابین دەکات. لە دەرەوەی ژمێریاریی سادە، ساغکردنەوەی بانک، بودجەبەندی لەگەڵ شیکاری جیاوازی، بەدواداچوونی ناوەندی تێچوو، و ڕاپۆرتی لێشاوی پارەی ئۆتۆماتیکی - هەموو ئەوانەی پێویستتە بۆ بەڕێوەبردنی پیشەیی دارایی.

---

## بۆچی ئەم تایبەتمەندییانە بەکار بهێنم؟

### سوودە سەرەکییەکان

| سوود | چۆن یارمەتی کارەکەت دەدات |
|------|---------------------------|
| **کۆنترۆڵی بانک** | ساغکردنەوەی هەژمارەکان مانگانە، هەڵەکان زوو بدۆزەوە |
| **بەڕێوەبردنی بودجە** | خەرجکردن پلان بکە، جیاوازی بەدواداوە، تێچوو کۆنترۆڵ بکە |
| **بینینی تێچوو** | بزانە هەر بەش/پڕۆژە چەند تێچووی هەیە |
| **تێگەیشتنی لێشاوی پارە** | تێبگە پارەکانت چۆن بەکاردێن |
| **ئامادەبوون بۆ وردبینی (Audit)** | تۆماری تەواو بۆ وردبینان و دەزگا باجییەکان |

### کێشەکانی چارەسەر دەکات

- **"کەشفی بانک لەگەڵ دەفتەرەکانمان یەک ناگرێتەوە"** - پرۆسەی ساغکردنەوەی مانگانە
- **"ئێمە زیادە خەرج دەکەین بەبێ ئەوەی بزانین"** - ئاگادارکردنەوەی جیاوازی بودجە
- **"کام بەش زۆرترین تێچووی هەیە؟"** - بەدواداچوونی ناوەندی تێچوو
- **"ئایا مانگی داهاتوو پارەمان هەیە؟"** - ڕاپۆرتی لێشاوی پارە
- **"ژمێریارەکەمان هەموو شتێک لە Excel دەکات"** - چارەسەری تەواو لە سیستەم

---

## کێ دەبێت ئەمە بخوێنێتەوە؟

| ڕۆڵ | بەشە پەیوەندیدارەکان |
|-----|---------------------|
| **ژمێریاران** | هەموو بەشەکان |
| **بەڕێوەبەرانی دارایی** | هەموو بەشەکان، بەتایبەتی بودجەبەندی |
| **بەڕێوەبەرانی بەش** | ناوەندی تێچوو، بودجە دژی ڕاستەقینە |
| **خاوەن کار** | لێشاوی پارە، پوختەی بودجە |
| **وردبینان** | ساغکردنەوە، شوێنپێی وردبینی |

---

## پێکهاتەکانی مۆدیوڵ

```
┌─────────────────────────────────────────────────────────────────────────┐
│                      باشترکردنی ژمێریاری                                │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ┌────────────────────┐   بەدواداچوونی هەژمارەکانی بانک و مامەڵەکان     │
│  │  بەڕێوەبردنی بانک  │   بەکاربهێنە کاتێک: بەڕێوەبردنی هەژمارەکانی بانک │
│  └────────────────────┘                                                 │
│                                                                         │
│  ┌────────────────────┐   ساغکردنەوەی کەشف لەگەڵ تۆمارەکانی دەفتەر      │
│  │   ساغکردنەوەی بانک │   بەکاربهێنە کاتێک: داخستنی مانگانە، ئامادەی بۆ وردبینی │
│  └────────────────────┘                                                 │
│                                                                         │
│  ┌────────────────────┐   پلاندانان و بەدواداچوونی خەرجکردن              │
│  │  سیستەمی بودجە     │   بەکاربهێنە کاتێک: پلانی ساڵانە، کۆنترۆڵی تێچوو  │
│  └────────────────────┘                                                 │
│                                                                         │
│  ┌────────────────────┐   بەدواداچوونی تێچوو بەپێی بەش/پڕۆژە            │
│  │  ناوەندی تێچوو     │   بەکاربهێنە کاتێک: بەرپرسیاریەتی بەشەکان         │
│  └────────────────────┘                                                 │
│                                                                         │
│  ┌────────────────────┐   شیکردنەوەی هاتوچۆی پارە                       │
│  │  ڕاپۆرتی لێشاوی پارە│   بەکاربهێنە کاتێک: پلانی نەقدینە، ڕاپۆرتی وەبەرهێنەران │
│  └────────────────────┘                                                 │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## تایبەتمەندی ١: بەڕێوەبردنی هەژماری بانک

### چییە؟

بەڕێوەبردنی هەژماری بانک هەموو هەژمارە بانکییەکانی کۆمپانیاکەت لە ناو GoPOS بەدوادەچێت. دانان (Deposit)، ڕاکێشان (Withdrawal)، گواستنەوە، و کرێ تۆمار بکە - هەمووی بەستراون بە هەژمارەکانی دەفتەری گشتی (GL).

### سوودە سەرەکییەکان

| سوود | وەسف |
|------|------|
| **بینینی ناوەندی** | هەموو هەژمارە بانکییەکان لە شوێنێکدا |
| **باڵانسی ڕاستەقینە** | هەمیشە باڵانسی ئێستا بزانە |
| **مێژووی مامەڵە** | تۆماری تەواوی هەموو جوڵانەوەکان |
| **یەکگرتنی GL** | بەستنی ئۆتۆماتیکی بە چارتی هەژمارەکان |
| **فرە دراو** | پشتگیری IQD، USD، و دراوەکانی تر |

### کەی بەکاربهێنە

| سیناریۆ | کردار |
|---------|-------|
| کردنەوەی هەژماری بانکی نوێ | هەژماری بانک لە سیستەم دروست بکە |
| وەرگرتنی پارەدانی کڕیار | دانان (Deposit) تۆمار بکە |
| پارەدان بە دابینکەر | ڕاکێشان/چەک تۆمار بکە |
| کرێی بانک بڕایەوە | مامەڵەی کرێ تۆمار بکە |
| سوودی وەرگیراو | مامەڵەی سوود تۆمار بکە |

### کەیسی بەکارهێنان: بەڕێوەبردنی چەند هەژماری بانک

**سیناریۆ:** کۆمپانیا هەژماری IQD و USD لە بانکی جیاوازدا هەیە

**دامەزراندن:**
1. هەژمار بۆ هەر هەژماری بانک دروست بکە
2. هەریەکە بە هەژماری GL ی تایبەت ببەستە
3. باڵانسی سەرەتا دابنێ

**کارەکانی ڕۆژانە:**
1. دانانەکان تۆمار بکە کاتێک پارە دێت
2. چەک/ڕاکێشانەکان تۆمار بکە کاتێک پارە دەچێت
3. سیستەم باڵانسەکان ئۆتۆماتیک نوێ دەکاتەوە
4. کۆتایی مانگ: ساغکردنەوە لەگەڵ کەشفی بانک

### چۆن بەکاربهێنە (هەنگاوەکانی UI)

#### دروستکردنی هەژماری بانک

1. بڕۆ بۆ **ژمێریاری > هەژمارەکانی بانک**
2. کلیک بکە لەسەر **دروستکردنی هەژماری بانک**
3. زانیارییەکان پڕ بکەوە:
   - **هەژماری GL** (بەستن بە هەژماری نەقد/بانک)
   - **ناوی بانک** (لە هەموو زمانەکان)
   - **ژمارەی هەژمار**
   - **IBAN** (ئەگەر هەبوو)
   - **دراو**
   - **باڵانسی سەرەتا**
4. کلیک بکە لەسەر **دروستکردن**

#### تۆمارکردنی مامەڵەکان

1. هەژماری بانک بکەرەوە
2. کلیک بکە لەسەر **زیادکردنی مامەڵە**
3. جۆری مامەڵە هەڵبژێرە:
   - **دانان** (Deposit) - پارەی هاتوو
   - **ڕاکێشان** (Withdrawal) - پارەی دەرچوو
   - **گواستنەوە** - نێوان هەژمارەکان
   - **کرێ** - کرێکانی بانک
   - **سوود** - سوودی بەدەستهاتوو
4. بڕ، بەروار، سەرچاوە، و وەسف بنووسە
5. پاشەکەوت بکە

### چۆن بەکاربهێنە (کۆد)

```php
use App\Models\BankAccount;
use App\Models\BankTransaction;

// دروستکردنی هەژماری بانک
$bankAccount = BankAccount::create([
    'account_id' => $glAccount->id,
    'bank_name' => 'Central Bank of Iraq',
    'bank_name_ar' => 'البنك المركزي العراقي',
    'bank_name_ckb' => 'بانکی ناوەندی عێراق',
    'account_number' => '1234567890',
    'iban' => 'IQ12 3456 7890 1234 5678',
    'swift_code' => 'CBIQIQBA',
    'branch' => 'لقی سەرەکی هەولێر',
    'currency_id' => $currency->id,
    'opening_balance' => 50000.00,
    'is_active' => true,
]);

// باڵانسی ئێستا بگرەوە
echo $bankAccount->current_balance;

// تۆمارکردنی دانان (Deposit)
$transaction = $bankAccount->recordTransaction([
    'type' => BankTransaction::TYPE_DEPOSIT,
    'description' => 'پارەدانی کڕیار وەرگیرا',
    'amount' => 5000.00,
    'transaction_date' => now(),
    'reference' => 'DEP-001',
    'status' => 'pending',
]);

// تۆمارکردنی ڕاکێشان/چەک
$transaction = $bankAccount->recordTransaction([
    'type' => BankTransaction::TYPE_WITHDRAWAL,
    'description' => 'پارەدان بە دابینکەر',
    'amount' => 2500.00,
    'transaction_date' => now(),
    'check_number' => 'CHK-0045',
    'payee' => 'دابینکەرانی ABC',
]);

// جۆرەکانی مامەڵە
BankTransaction::TYPE_DEPOSIT;    // پارەی هاتوو
BankTransaction::TYPE_WITHDRAWAL; // پارەی دەرچوو
BankTransaction::TYPE_TRANSFER;   // گواستنەوەی نێوان بانک
BankTransaction::TYPE_FEE;        // کرێکانی بانک
BankTransaction::TYPE_INTEREST;   // سوودی بەدەستهاتوو

// مامەڵە وەک پاکبوو (Cleared) نیشان بکە
$transaction->markCleared();
```

### باشترین ڕێکارەکان

| بکە | مەکە |
|-----|------|
| مامەڵەکان ڕۆژانە تۆمار بکە | چاوەڕێ بکە تا کۆتایی مانگ |
| سەرچاوەی وەسفکەر بەکاربهێنە | وەسفەکان بەتاڵ بهێڵەوە |
| بە هەژمارەکانی GL بە دروستی ببەستە | هەژماری جیاکراوە دروست بکە |
| کرێکانی بانک بەزوویی تۆمار بکە | کرێ بچووکەکان پشتگوێ بخە |

---

## تایبەتمەندی ٢: ساغکردنەوەی بانک (Reconciliation)

### چییە؟

ساغکردنەوەی بانک تۆمارەکانی دەفتەرەکەت لەگەڵ کەشفی ڕاستەقینەی بانک دەگونجێنێت (ساغ دەکاتەوە). چەکی چاوەڕوان، دانانی لە ڕێگا، کرێی بانک، و هەڵەکان دەناسێتەوە - مسۆگەر دەکات دەفتەرەکانت لەگەڵ ڕاستی دەگونجێت.

### سوودە سەرەکییەکان

| سوود | وەسف |
|------|------|
| **دروستی** | هەڵەکان بگرەوە پێش ئەوەی کێشە دروست بکەن |
| **دۆزینەوەی فێڵ** | مامەڵەی نائاسایی بناسەوە |
| **شوێنپێی وردبینی** | پشتڕاستکردنەوەی مانگانە تۆماربکە |
| **دەفتەری پاک** | داخستنی کۆتایی مانگ بە متمانە |
| **کۆنترۆڵ** | تەنها بزانە چی لە بانک دەرچوو |

### کەی بەکاربهێنە

| سیناریۆ | ساغکردنەوە بەکاربهێنە |
|---------|---------------------|
| داخستنی مانگانە | بەڵێ - پێویستە |
| کەشفی بانک گەیشت | بەڵێ - دەستبەجێ ساغ بکەرەوە |
| وردبینی کۆتایی ساڵ | بەڵێ - دڵنیا ببە هەموو مانگەکان ساغکراونەتەوە |
| چالاکی گومانلێکراو | بەڵێ - جیاوازییەکان بناسەوە |
| کێشەی لێشاوی پارە | بەڵێ - شتە چاوەڕوانەکان بدۆزەوە |

### کەیسی بەکارهێنان: ساغکردنەوەی مانگانەی بانک

**سیناریۆ:** کەشفی کانوونی دووەم گەیشت بە باڵانسی کۆتایی ٥٢،٥٠٠ IQD

**پرۆسە:**
1. ساغکردنەوە بۆ کانوونی دووەم دروست بکە
2. باڵانسی کەشف بنووسە: ٥٢،٥٠٠ IQD
3. سیستەم باڵانسی دەفتەر پیشان دەدات: ٥٥،٠٠٠ IQD
4. جیاوازی: ٢،٥٠٠ IQD
5. بناسەوە:
   - چەکی چاوەڕوان #٤٥: ٣،٠٠٠ IQD (هێشتا نەگۆڕاوە)
   - کرێی خزمەتگوزاری بانک: ٥٠٠ IQD (تۆمارنەکراو)
6. بەندەکان زیاد بکە بۆ ساغکردنەوە
7. باڵانسی ڕێکخراوی نوێ: ٥٢،٥٠٠ IQD (یەکسانە!)
8. ساغکردنەوە تەواو بکە

### هاوکێشەی ساغکردنەوە

```
باڵانسی دەفتەر                     ٥٥،٠٠٠
- کرێی بانک (هێشتا تۆمارنەکراو)       (٥٠٠)
= باڵانسی ڕێکخراوی دەفتەر          ٥٤،٥٠٠

باڵانسی کەشف                       ٥٢،٥٠٠
- چەکی چاوەڕوان                    (٣،٠٠٠)
+ دانانی لە ڕێگا (Transit)         ٥،٠٠٠
= باڵانسی ڕێکخراوی بانک            ٥٤،٥٠٠

جیاوازی: ٠ (ساغ بووەوە!)
```

### چۆن بەکاربهێنە (هەنگاوەکانی UI)

#### دەستپێکردنی ساغکردنەوە

1. بڕۆ بۆ **ژمێریاری > ساغکردنەوەی بانک**
2. کلیک بکە لەسەر **ساغکردنەوەی نوێ**
3. **هەژماری بانک** هەڵبژێرە
4. بنووسە:
   - **بەرواری کەشف** (وەک، ٣١ی کانوونی دووەم، ٢٠٢٦)
   - **باڵانسی کەشف** (لە کەشفی بانک)
   - **سەرەتا/کۆتایی ماوە**
5. کلیک بکە لەسەر **دروستکردن**

#### کارکردن لەگەڵ بەندەکان

1. سیستەم هەموو مامەڵە ساغ نەکراوەکان پیشان دەدات
2. بۆ هەر بەندێک لە کەشفی بانک:
   - ئەگەر لەگەڵ تۆماری دەفتەر دەگونجێت، وەک **پاکبوو** (Cleared) نیشان بکە
   - ئەگەر لە دەفتەرەکانتدا نییە (کرێی بانک)، وەک **ڕێکخستن** زیاد بکە
3. بۆ تۆمارەکانی دەفتەر کە لە کەشف نییە:
   - وەک **چەکی چاوەڕوان** یان **دانانی لە ڕێگا** نیشان بکە

#### تەواوکردنی ساغکردنەوە

1. **پوختە** ببینە کە پیشان دەدات:
   - باڵانسی دەفتەر دژی باڵانسی ڕێکخراوی دەفتەر
   - باڵانسی کەشف دژی باڵانسی ڕێکخراوی بانک
   - جیاوازی (دەبێت ٠ بێت)
2. ئەگەر هاوسەنگە، کلیک بکە لەسەر **تەواوکردنی ساغکردنەوە**
3. سیستەم تۆماری ڕۆژنامە دروست دەکات بۆ ڕێکخستنەکان
4. مامەڵەکان وەک ساغ بووەوە (Reconciled) نیشان دەکرێن

### چۆن بەکاربهێنە (کۆد)

```php
use App\Services\BankReconciliationService;

$reconciliationService = app(BankReconciliationService::class);

// دروستکردنی ساغکردنەوەی نوێ
$reconciliation = $reconciliationService->createReconciliation(
    bankAccount: $bankAccount,
    statementBalance: 52500.00,
    statementDate: '2026-01-31',
    statementStartDate: '2026-01-01',
    statementEndDate: '2026-01-31'
);

// چەکی چاوەڕوان بگرەوە (Outstanding Checks)
$outstandingChecks = $reconciliationService->getOutstandingChecks(
    $bankAccount,
    '2026-01-31'
);

// چەکی چاوەڕوان زیاد بکە بۆ ساغکردنەوە
foreach ($outstandingChecks as $check) {
    $reconciliationService->addOutstandingCheck($reconciliation, $check);
}

// دانانی لە ڕێگا بگرەوە (Deposits in Transit)
$depositsInTransit = $reconciliationService->getDepositsInTransit(
    $bankAccount,
    '2026-01-31'
);

// دانانی لە ڕێگا زیاد بکە
foreach ($depositsInTransit as $deposit) {
    $reconciliationService->addDepositInTransit($reconciliation, $deposit);
}

// کرێی بانک زیاد بکە (ڕێکخستن دروست دەکات)
$reconciliationService->addBankCharge(
    $reconciliation,
    25.00,
    'کرێی خزمەتگوزاری مانگانە'
);

// سوودی بانک زیاد بکە
$reconciliationService->addBankInterest(
    $reconciliation,
    15.50,
    'سوودی بەدەستهاتوو'
);

// پوختە حیساب بکە
$summary = $reconciliationService->calculateSummary($reconciliation);

echo "باڵانسی دەفتەر: " . $summary['book_balance'];
echo "باڵانسی ڕێکخراوی دەفتەر: " . $summary['adjusted_book_balance'];
echo "باڵانسی کەشف: " . $summary['statement_balance'];
echo "چەکی چاوەڕوان: " . $summary['outstanding_checks'];
echo "دانانی لە ڕێگا: " . $summary['deposits_in_transit'];
echo "جیاوازی: " . $summary['difference'];
echo "ساغ بووەتەوە: " . ($summary['is_balanced'] ? 'بەڵێ' : 'نەخێر');

// تەواوکردنی ساغکردنەوە
$reconciliationService->completeReconciliation(
    $reconciliation,
    bankChargeAccountId: $bankChargesExpenseAccountId,
    interestIncomeAccountId: $interestIncomeAccountId
);
```

### باشترین ڕێکارەکان

| بکە | مەکە |
|-----|------|
| لە هەفتەی یەکەمی مانگ ساغ بکەرەوە | چاوەڕێ بکە تا کۆتایی وەرز |
| هەموو جیاوازییەکان لێکۆڵینەوە بکە | بڕە بچووکەکان پشتگوێ بخە |
| ڕێکخستنەکان بە ڕوونی تۆمار بکە | تۆماری ڕوون نەکراو بکە |
| کەشفی بانک پاشەکەوت بکە | کەشفەکان فڕێ بدە |
| پێش داخستنی ماوە تەواو بکە | ماوە دابخە بەبێ ساغکردنەوە |

---

## تایبەتمەندی ٣: سیستەمی بودجەبەندی

### چییە؟

سیستەمی بودجەبەندی ڕێگات دەدات بودجەی ساڵانە دروست بکەیت، خەرجکردن بەراورد بە بودجە بەدواداوە، جیاوازییەکان بناسەوە، و ڕێکخستن بکەیت. پلاندانان بەراورد بە خەرجکردنی ڕاستەقینە بەپێی هەژمار و ناوەندی تێچوو.

### سوودە سەرەکییەکان

| سوود | وەسف |
|------|------|
| **کۆنترۆڵی تێچوو** | سنوور دابنێ پێش خەرجکردن |
| **ئاگادارکردنەوەی جیاوازی** | دەستبەجێ بزانە کەی لە سەر بودجەیە |
| **پلاندانان** | پلانی ساڵانە بەپێی بەش |
| **بەرپرسیاریەتی** | ڕاستەقینە بەراورد بە پلان |
| **پشتگیری بڕیار** | داتا بۆ دابەشکردنی سەرچاوەکان |

### کەی بەکاربهێنە

| سیناریۆ | بودجەبەندی بەکاربهێنە |
|---------|----------------------|
| پلاندانانی ساڵانە | بودجەی ساڵی داهاتوو دروست بکە |
| خەرجکردنی بەش | بەپێی ناوەندی تێچوو دابەش بکە |
| بودجەبەندی پڕۆژە | بودجەی پڕۆژە دروست بکە |
| پێداچوونەوەی مانگانە | ڕاپۆرتی جیاوازی ببینە |
| زیادبوونی تێچوو | ڕێکخستنی بودجە دروست بکە |

### کەیسی بەکارهێنان: بودجەی کارکردنی ساڵانە

**سیناریۆ:** پلاندانانی بودجەی کارکردنی ٢٠٢٦

**پرۆسە:**
1. بودجە بۆ ساڵی دارایی ٢٠٢٦ دروست بکە
2. هێڵی بودجە زیاد بکە بۆ هەر هەژماری خەرجی
3. بڕەکان بەپێی مانگ دابەش بکە
4. بۆ پەسەندکردنی بەڕێوەبەرایەتی پێشکەش بکە
5. کاتێک پەسەند کرا چالاک بکە
6. مانگانە بەراورد بە ڕاستەقینە بکە

**نمونەی بودجە:**
```
هەژمار              کانوونی دووەم  شوبات   ئازار    ...    کۆی گشتی
مووچە              ٥٠،٠٠٠   ٥٠،٠٠٠   ٥٠،٠٠٠   ...   ٦٠٠،٠٠٠
کرێی شوێن          ١٠،٠٠٠   ١٠،٠٠٠   ١٠،٠٠٠   ...   ١٢٠،٠٠٠
خزمەتگوزارییەکان     ٢،٠٠٠    ٢،٠٠٠    ٢،٥٠٠   ...    ٢٨،٠٠٠
بازاڕکردن            ٥،٠٠٠    ٣،٠٠٠    ٨،٠٠٠   ...    ٧٢،٠٠٠
```

### جۆرەکانی بودجە

| جۆر | مەبەست | کەی بەکاربهێنە |
|-----|--------|---------------|
| **کارکردن (Operating)** | خەرجییەکانی ڕۆژانە | پلاندانانی خەرجی ساڵانە |
| **سەرمایە (Capital)** | کڕینی سامان | ئامێر، ئۆتۆمبێل، بینا |
| **لێشاوی پارە** | پێشبینیی نەقد | پلاندانانی نەقدینە |
| **پڕۆژە** | پڕۆژەی تایبەت | خەرجکردنی بنچینەی پڕۆژە |

### چۆن بەکاربهێنە (هەنگاوەکانی UI)

#### دروستکردنی بودجە

1. بڕۆ بۆ **ژمێریاری > بودجەکان**
2. کلیک بکە لەسەر **دروستکردنی بودجە**
3. بنووسە:
   - **ناو** (لە هەموو زمانەکان)
   - **ماوەی دارایی** (ساڵ)
   - **جۆری بودجە** (کارکردن، سەرمایە، هتد)
4. کلیک بکە لەسەر **دروستکردن**

#### زیادکردنی هێڵی بودجە

1. بودجەکە بکەرەوە
2. کلیک بکە لەسەر **زیادکردنی هێڵ**
3. هەڵبژێرە:
   - **هەژماری GL** (هەژماری خەرجی)
   - **ناوەندی تێچوو** (ئارەزوومەندانە)
4. بڕەکان بنووسە بۆ هەر مانگ
5. یان ئامرازی دابەشکردن بەکاربهێنە:
   - **دابەشکردنی یەکسان** - هەمان بڕ هەر مانگ
   - **دابەشکردنی بەپێی ڕێزبەندی** - ڕێزبەندی وەرزی
6. تێبینی زیاد بکە کە بڕەکە ڕوون بکات
7. پاشەکەوت بکە

#### پەسەندکردنی بودجە

1. کاتێک هەموو هێڵەکان زیاد کران، کلیک بکە لەسەر **پێشکەشکردن بۆ پەسەندکردن**
2. بەڕێوەبەر پێداچوونەوە دەکات و کلیک دەکات لەسەر **پەسەندکردن**
3. کلیک بکە لەسەر **چالاککردن** بۆ دەستپێکردنی بەدواداچوون

#### بینینی بودجە دژی ڕاستەقینە

1. بڕۆ بۆ **ڕاپۆرتەکان > بودجە دژی ڕاستەقینە**
2. بودجە و ماوە هەڵبژێرە
3. ببینە:
   - بڕی بودجەکراو بەپێی هەژمار
   - خەرجکردنی ڕاستەقینە
   - جیاوازی (بڕ و %)
   - نیشانەی لەسەر/لەژێر بودجە

### چۆن بەکاربهێنە (کۆد)

```php
use App\Services\BudgetService;
use App\Models\Budget;

$budgetService = app(BudgetService::class);

// دروستکردنی بودجەی کارکردن
$budget = $budgetService->createBudget(
    name: 'بودجەی کارکردنی ٢٠٢٦',
    fiscalPeriod: $fiscalPeriod,
    budgetType: Budget::TYPE_OPERATING,
    nameAr: 'ميزانية التشغيل 2026',
    nameCkb: 'بودجەی کارکردنی ٢٠٢٦'
);

// زیادکردنی هێڵی بودجە بە بڕی مانگانە
$budgetService->addBudgetLine(
    budget: $budget,
    account: $salariesAccount,
    monthlyAmounts: [50000, 50000, 50000, 50000, 50000, 50000,
                     50000, 50000, 50000, 50000, 50000, 50000],
    costCenter: $hrDepartment,
    notes: 'مووچەی مانگانە بۆ بەشی HR'
);

// دابەشکردنی یەکسانی بڕی ساڵانە
$monthlyAmounts = $budgetService->distributeEvenly(120000);
// دەگەڕێتەوە: [10000, 10000, 10000, ...]

// دابەشکردن بەپێی ڕێزبەندی وەرزی
$pattern = [8, 8, 10, 10, 12, 12, 10, 10, 8, 6, 3, 3]; // ڕێژەکان
$monthlyAmounts = $budgetService->distributeByPattern(120000, $pattern);
// زیاتر لە مانگەکانی هاوین، کەمتر لە زستان

// پەسەندکردن و چالاککردن
$budget->approve();
$budget->activate();

// ڕاپۆرتی جیاوازی بگرەوە
$report = $budgetService->getBudgetVsActualReport($budget);

foreach ($report['lines'] as $line) {
    echo "هەژمار: " . $line['account']->name;
    echo "بودجەکراو: " . $line['annual']['budgeted'];
    echo "ڕاستەقینە: " . $line['annual']['actual'];
    echo "جیاوازی: " . $line['annual']['variance'];
    echo "% جیاوازی: " . $line['annual']['variance_percent'] . "%";
}

// ئاگادارییەکانی لە سەر بودجە (>١٠٪ لەسەر)
$alerts = $budgetService->getVarianceAlerts($budget, threshold: 10);

foreach ($alerts as $alert) {
    echo "ئاگاداری: {$alert['account']->name} {$alert['variance_percent']}% لەسەر بودجەیە";
}

// دروستکردنی ڕێکخستنی بودجە بۆ گۆڕانکاریی ناو ساڵ
$revision = $budgetService->createRevision(
    $budget,
    'ڕێکخستنی ناو ساڵ بۆ زیادبوونی بازاڕکردن',
    [
        $lineId => ['july' => 8000, 'august' => 8000, 'september' => 8000]
    ]
);

// کۆپیکردنی بودجە بۆ ساڵی داهاتوو بە ٥٪ زیادبوون
$newBudget = $budgetService->copyBudget(
    $lastYearBudget,
    $newFiscalPeriod,
    adjustmentPercent: 5
);
```

### باشترین ڕێکارەکان

| بکە | مەکە |
|-----|------|
| بودجە دروست بکە پێش دەستپێکردنی ساڵی دارایی | بودجە ناو ساڵ دروست بکە |
| مانگانە جیاوازی پێداچوونەوە بکە | چاوەڕێ بکە تا کۆتایی ساڵ |
| ناوەندی تێچوو بۆ بەشەکان بەکاربهێنە | هەموو شتێک لە خانەیەکدا بخە |
| ڕێکخستن بکە بۆ گۆڕانی >١٠٪ | بودجە پشتگوێ بخە دوای پەسەندکردن |
| گریمانەکان لە تێبینی تۆمار بکە | هێڵی بودجە بەبێ ڕوونکردنەوە بهێڵەوە |

---

## تایبەتمەندی ٤: ژمێریاری ناوەندی تێچوو

### چییە؟

ناوەندی تێچوو (Cost Center) داهات و خەرجی بەپێی بەش، پڕۆژە، شوێن، یان هەر یەکەیەکی ڕێکخستنی بەدوادەچێت. قازانج و خەرجکردنی هەر بەشێکی کارەکەت جیا ببینە.

### سوودە سەرەکییەکان

| سوود | وەسف |
|------|------|
| **بەرپرسیاریەتی بەشەکان** | هەر بەشێک تێچووەکانی خۆی بەدوادەچێت |
| **بەدواداچوونی پڕۆژە** | بزانە پڕۆژەکان قازانجیانە |
| **بڕیاردان** | داتا بۆ دابەشکردنی سەرچاوەکان |
| **بودجەبەندی** | بودجە بەپێی ناوەندی تێچوو |
| **کارایی** | بەراوردی کارایی بەشەکان |

### جۆرەکانی ناوەندی تێچوو

| جۆر | مەبەست | نمونە |
|-----|--------|-------|
| **بەش** | یەکەی ڕێکخستنی | فرۆشتن، HR، IT |
| **پڕۆژە** | پڕۆژەی تایبەت | جێبەجێکردنی ERP |
| **شوێن** | جوگرافی | ئۆفیسی هەولێر، ئۆفیسی بەغداد |
| **هێڵی بەرهەم** | گروپی بەرهەم | ئەلیکترۆنی، کەلوپەل |

### کەی بەکاربهێنە

| سیناریۆ | ناوەندی تێچوو بەکاربهێنە |
|---------|-------------------------|
| چەند بەش | تێچووی هەر بەش بەدواداوە |
| کاری بنچینەی پڕۆژە | قازانجی پڕۆژە بەدواداوە |
| چەند شوێن | کارایی شوێنەکان بەراورد بکە |
| دابەشکردنی بودجە | بودجە بەپێی بەش دابەش بکە |
| ڕاپۆرتی بەڕێوەبەرایەتی | ڕاپۆرت بەپێی بەرپرسیاریەتی |

### کەیسی بەکارهێنان: بەدواداچوونی تێچووی بەش

**سیناریۆ:** بەدواداچوونی تێچوو بۆ بەشی فرۆشتن، HR، و IT

**دامەزراندن:**
1. ناوەندی تێچوو دروست بکە: CC-SALES، CC-HR، CC-IT
2. بەڕێوەبەر دابنێ بۆ هەریەکە
3. کاتێک خەرجی تۆمار دەکەیت، ناوەندی تێچوو هەڵبژێرە
4. ڕاپۆرت بەپێی ناوەندی تێچوو ڕابگرە

**ئەنجام:**
```
بەش       بودجە     ڕاستەقینە   جیاوازی
فرۆشتن    ١٠٠،٠٠٠   ٩٥،٠٠٠    -٥،٠٠٠ (لەژێر)
HR        ٥٠،٠٠٠    ٥٢،٠٠٠    +٢،٠٠٠ (لەسەر)
IT        ٧٥،٠٠٠    ٧٠،٠٠٠    -٥،٠٠٠ (لەژێر)
```

### چۆن بەکاربهێنە (هەنگاوەکانی UI)

#### دروستکردنی ناوەندی تێچوو

1. بڕۆ بۆ **ژمێریاری > ناوەندی تێچوو**
2. کلیک بکە لەسەر **دروستکردنی ناوەندی تێچوو**
3. بنووسە:
   - **کۆد** (وەک، CC-SALES)
   - **ناو** (لە هەموو زمانەکان)
   - **جۆر** (بەش، پڕۆژە، هتد)
   - **بەڕێوەبەر** (ئارەزوومەندانە)
   - **باوان** (بۆ ئاستی ڕیزبەندی)
4. کلیک بکە لەسەر **دروستکردن**

#### دابەشکردنی تێچوو

کاتێک مامەڵە دروست دەکەیت:
1. لە تۆماری ڕۆژنامە، ناوەندی تێچوو هەڵبژێرە بۆ هەر هێڵ
2. لە خەرجییەکان، ناوەندی تێچوو هەڵبژێرە
3. لە هێڵی بودجە، ناوەندی تێچوو هەڵبژێرە

#### بینینی ڕاپۆرتی ناوەندی تێچوو

1. بڕۆ بۆ **ڕاپۆرتەکان > شیکاری ناوەندی تێچوو**
2. ناوەندی تێچوو و ماوە هەڵبژێرە
3. ببینە:
   - کۆی خەرجییەکان
   - کۆی داهات (ئەگەر هەبوو)
   - قازانج/زەرەر
   - بەراوردی بودجە

### چۆن بەکاربهێنە (کۆد)

```php
use App\Models\CostCenter;
use App\Models\JournalEntryLine;
use App\Models\Expense;

// دروستکردنی ناوەندی تێچوو بۆ بەش
$salesDept = CostCenter::create([
    'code' => 'CC-SALES',
    'name' => 'Sales Department',
    'name_ar' => 'قسم المبيعات',
    'name_ckb' => 'بەشی فرۆشتن',
    'type' => CostCenter::TYPE_DEPARTMENT,
    'manager_id' => $salesManager->id,
    'is_active' => true,
]);

// دروستکردنی ناوەندی تێچوو بۆ پڕۆژە
$project = CostCenter::create([
    'code' => 'CC-PROJ-001',
    'name' => 'ERP Implementation Project',
    'type' => CostCenter::TYPE_PROJECT,
    'parent_id' => $itDept->id,
    'is_active' => true,
]);

// جۆرەکانی ناوەندی تێچوو
CostCenter::TYPE_DEPARTMENT;   // یەکەی ڕێکخستنی
CostCenter::TYPE_PROJECT;      // بنچینەی پڕۆژە
CostCenter::TYPE_LOCATION;     // شوێنی جوگرافی
CostCenter::TYPE_PRODUCT_LINE; // هێڵی بەرهەم

// دابەشکردنی ناوەندی تێچوو بۆ هێڵی تۆماری ڕۆژنامە
JournalEntryLine::create([
    'journal_entry_id' => $entry->id,
    'account_id' => $expenseAccount->id,
    'cost_center_id' => $salesDept->id,
    'debit' => 1000,
    'credit' => 0,
]);

// دابەشکردنی ناوەندی تێچوو بۆ خەرجی
Expense::create([
    'expense_type_id' => $type->id,
    'cost_center_id' => $salesDept->id,
    'amount' => 500,
    'description' => 'کەلوپەلی ئۆفیس بۆ تیمی فرۆشتن',
]);

// داتای دارایی بگرەوە بۆ ناوەندی تێچوو
$startDate = '2026-01-01';
$endDate = '2026-12-31';

$expenses = $costCenter->getTotalExpensesForPeriod($startDate, $endDate);
$revenue = $costCenter->getTotalRevenueForPeriod($startDate, $endDate);
$profitLoss = $costCenter->getProfitLossForPeriod($startDate, $endDate);

// پوختەی بودجە بگرەوە بۆ ناوەندی تێچوو
$summary = $budgetService->getCostCenterBudgetSummary($costCenter, $fiscalPeriod);
echo "بودجەکراو: " . $summary['total_budgeted'];
echo "ڕاستەقینە: " . $summary['total_actual'];
echo "جیاوازی: " . $summary['total_variance'];
```

### باشترین ڕێکارەکان

| بکە | مەکە |
|-----|------|
| سکیمای کۆدی یەکگرتوو بەکاربهێنە (CC-XXX) | کۆدی هەرەمەکی بەکاربهێنە |
| بەڕێوەبەر بۆ بەرپرسیاریەتی دابنێ | بەبێ دابەشکردن بهێڵەوە |
| هەموو خەرجییە گرنگەکان بەدواداوە | تەنها هەندێک بەدواداوە |
| ڕاپۆرتەکان مانگانە پێداچوونەوە بکە | ڕاپۆرتی ناوەندی تێچوو پشتگوێ بخە |
| لەگەڵ پێکهاتەی ڕێکخستنی یەکگرتوو بکە | گروپی هەرەمەکی دروست بکە |

---

## تایبەتمەندی ٥: ڕاپۆرتی لێشاوی پارە (Cash Flow)

### چییە؟

ڕاپۆرتی لێشاوی پارە پیشان دەدات پارە لە کوێوە هاتوو و چوو بۆ کوێ لە ماوەیەکدا. بە کارچالاکییەکانی کارکردن، وەبەرهێنان، و دارایی ڕێکخراوە - پێویستە بۆ تێگەیشتن لە بارودۆخی نەقدینەیی کارەکەت.

### سوودە سەرەکییەکان

| سوود | وەسف |
|------|------|
| **بینینی نەقد** | بزانە پارە بۆ کوێ دەچێت |
| **پلانی شلەداری (Liquidity)** | پلان بۆ پێداویستی نەقد |
| **ڕاپۆرتی وەبەرهێنەران** | ڕاپۆرتی دارایی ستاندارد |
| **دۆزینەوەی کێشە** | دزەی پارە بناسەوە |
| **پشتگیری بڕیار** | پشتگیری بڕیاری سەرمایە |

### بەشەکانی لێشاوی پارە

| بەش | چی پیشان دەدات | نمونە |
|-----|----------------|-------|
| **کارکردن (Operating)** | پارە لە کارچالاکییەکانی کار | فرۆشتن، خەرجییەکان، سەرمایەی کار |
| **وەبەرهێنان (Investing)** | پارە بۆ سامانی دوورخایەن | کڕینی ئامێر، فرۆشتنی سامان |
| **دارایی (Financing)** | پارە لە دارایی | قەرز، بەشداری خاوەن |

### کەی بەکاربهێنە

| سیناریۆ | ڕاپۆرتی لێشاوی پارە ڕابگرە |
|---------|---------------------------|
| پێداچوونەوەی مانگانەی بەڕێوەبەرایەتی | بەڵێ |
| داواکاری قەرزی بانک | بەڵێ |
| پێشکەشکردن بۆ وەبەرهێنەران | بەڵێ |
| پلاندانانی نەقد | بەڵێ |
| وردبینی کۆتایی ساڵ | بەڵێ |

### کەیسی بەکارهێنان: پێداچوونەوەی مانگانەی لێشاوی پارە

**سیناریۆ:** بەڕێوەبەرایەتی دەیانەوێت بارودۆخی نەقدی کانوونی دووەم تێبگەن

**دەرئەنجامی ڕاپۆرت:**
```
ڕاپۆرتی لێشاوی پارە - کانوونی دووەم ٢٠٢٦

کارچالاکییەکانی کارکردن
  قازانجی نێت                       ١٥،٠٠٠
  زیادکردن: خەرجی داخوران (Depreciation) 2,000
  کەمکردن: زیادی داواکاری (Receivables) (5,000)
  زیادکردن: زیادی قەرزەکان (Payables)    3,000
  نێت لە کارکردن                  ١٥،٠٠٠

کارچالاکییەکانی وەبەرهێنان
  کڕینی ئامێر                    (١٠،٠٠٠)
  نێت لە وەبەرهێنان              (١٠،٠٠٠)

کارچالاکییەکانی دارایی
  بەشداری سەرمایەی خاوەن          ٥،٠٠٠
  نێت لە دارایی                    ٥،٠٠٠

پوختە
  نەقدی سەرەتا                    ٥٠،٠٠٠
  گۆڕانی نێتی نەقد                ١٠،٠٠٠
  نەقدی کۆتایی                    ٦٠،٠٠٠
```

### چۆن بەکاربهێنە (هەنگاوەکانی UI)

1. بڕۆ بۆ **ڕاپۆرتەکان > دارایی > ڕاپۆرتی لێشاوی پارە**
2. ماوە هەڵبژێرە
3. کلیک بکە لەسەر **دروستکردن**
4. ڕاپۆرت ببینە لەگەڵ:
   - کارچالاکییەکانی کارکردن
   - کارچالاکییەکانی وەبەرهێنان
   - کارچالاکییەکانی دارایی
   - پوختە

### چۆن بەکاربهێنە (کۆد)

```php
use App\Services\FinancialReportingService;

$reportingService = app(FinancialReportingService::class);

// دروستکردنی ڕاپۆرتی لێشاوی پارە
$report = $reportingService->generateCashFlowStatement(
    startDate: '2026-01-01',
    endDate: '2026-01-31'
);

// دەستگەیشتن بە بەشەکان
$operating = $report['operating_activities'];
$investing = $report['investing_activities'];
$financing = $report['financing_activities'];

// کۆی گشتی
echo "نێتی کارکردن: " . $operating['total'];
echo "نێتی وەبەرهێنان: " . $investing['total'];
echo "نێتی دارایی: " . $financing['total'];

echo "نەقدی سەرەتا: " . $report['opening_cash'];
echo "نەقدی کۆتایی: " . $report['closing_cash'];
```

---

## سەرچاوەی تەکنیکی

### خزمەتگوزارییەکان

| خزمەتگوزاری | مەبەست |
|-------------|--------|
| `BankReconciliationService` | ساغکردنەوەی کەشف و تۆمارەکان |
| `BudgetService` | دروستکردن و بەدواداچوونی بودجە |
| `CostCenterService` | دابەشکردن و ڕاپۆرتی ناوەندی تێچوو |
| `FinancialReportingService` | لێشاوی پارە، لیستی داهات، تەرازوو |

### خشتەکانی بنکەی داتا (Database)

| خشتە | مەبەست |
|------|--------|
| `bank_accounts` | پێناسەی هەژماری بانک |
| `bank_transactions` | جوڵەی دانان/ڕاکێشان |
| `bank_reconciliations` | ساغکردنەوەی مانگانە |
| `reconciliation_items` | بەندەکانی ساغکردنەوە |
| `budgets` | سەردێڕی بودجە |
| `budget_lines` | بڕی بودجەکراوی هەژمار |
| `cost_centers` | پێناسەی بەش/پڕۆژە |

---

## چارەسەرکردنی کێشەکان

### ساغکردنەوەی بانک یەکسان نابێت

**کێشە:** جیاوازی سفر نییە.

**چارەسەرەکان:**
1. باڵانسی سەرەتا بپشکنە
2. پشتڕاست بکەوە هەموو مامەڵەکانی بانک تۆمارکراون
3. بۆ ژمارەی هەڵە بگەڕێ (Transposition error، وەک 54 vs 45)
4. دڵنیابە چەکی ساڵی پار هەمووی ساغ کراوەتەوە

---

### بودجە نیشان نادرێت لە ڕاپۆرت

**کێشە:** ستوونی بودجە بەتاڵە.

**چارەسەرەکان:**
1. بپشکنە بودجە **پەسەندکراوە** و **چالاکە**
2. دڵنیابە ماوەی ڕاپۆرت لەگەڵ ساڵی دارایی بودجە دەگونجێت
3. پشتڕاست بکەوە هێڵی بودجە بۆ هەژمارەکان زیاد کراوە

---

### ناوەندی تێچوو هەڵەیە

**کێشە:** خەرجی لە ناوەندی تێچووی هەڵە دەردەکەوێت.

**چارەسەرەکان:**
1. دەستکاری مامەڵەکە بکە و ناوەندی تێچوو چاک بکە
2. ئەگەر پۆست کراوە، تۆماری ڕۆژنامەی ڕاستکردنەوە (Reclassification) دروست بکە

---

*دوایین نوێکردنەوە: کانوونی دووەم ٢٠٢٦*
